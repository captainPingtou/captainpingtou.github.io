(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{169:function(t,s,a){t.exports=a.p+"assets/img/1576552978(1)-1576553193535.50862a46.jpg"},170:function(t,s,a){t.exports=a.p+"assets/img/1576552947(1).3707eeec.jpg"},171:function(t,s,a){t.exports=a.p+"assets/img/1576554575(1).c450ff56.jpg"},172:function(t,s){t.exports="data:image/jpeg;base64,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"},173:function(t,s,a){t.exports=a.p+"assets/img/1576574249(1).8638c888.jpg"},209:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"分布式事务seata的使用方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分布式事务seata的使用方法"}},[this._v("#")]),this._v(" 分布式事务seata的使用方法")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"seata-是什么？"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seata-是什么？"}},[this._v("#")]),this._v(" Seata 是什么？")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"seata的设计思想"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seata的设计思想"}},[this._v("#")]),this._v(" Seata的设计思想")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(169),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("Transaction Coordinator (TC)：  事务协调器，它是独立的中间件，需要独立部署运行，它维护全局事务的运 行状态，接收TM指令发起全局事务的提交与回滚，负责与RM通信协调各各分支事务的提交或回滚。")]),this._v(" "),s("li",[this._v("Transaction Manager (TM)： 事务管理器，TM需要嵌入应用程序中工作，它负责开启一个全局事务，并最终 向TC发起全局提交或全局回滚的指令。")]),this._v(" "),s("li",[this._v("Resource Manager (RM)： 控制分支事务，负责分支注册、状态汇报，并接收事务协调器TC的指令，驱动分 支（本地）事务的提交和回滚。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(170),alt:""}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ol",[a("li",[t._v("用户服务的 TM 向 TC 申请开启一个全局事务，全局事务创建成功并生成一个全局唯一的XID。")]),t._v(" "),a("li",[t._v("用户服务的 RM 向 TC 注册 分支事务，该分支事务在用户服务执行新增用户逻辑，并将其纳入 XID 对应全局 事务的管辖。")]),t._v(" "),a("li",[t._v("用户服务执行分支事务，向用户表插入一条记录。")]),t._v(" "),a("li",[t._v("逻辑执行到远程调用积分服务时(XID 在微服务调用链路的上下文中传播)。积分服务的RM 向 TC 注册分支事 务，该分支事务执行增加积分的逻辑，并将其纳入 XID 对应全局事务的管辖。")]),t._v(" "),a("li",[t._v("积分服务执行分支事务，向积分记录表插入一条记录，执行完毕后，返回用户服务。")]),t._v(" "),a("li",[t._v("用户服务分支事务执行完毕。")]),t._v(" "),a("li",[t._v("TM 向 TC 发起针对 XID 的全局提交或回滚决议。")]),t._v(" "),a("li",[t._v("TC 调度 XID 下管辖的全部分支事务完成提交或回滚请求。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"seata实现2pc与传统2pc的差别："}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seata实现2pc与传统2pc的差别："}},[this._v("#")]),this._v(" Seata实现2PC与传统2PC的差别：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"具体步骤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#具体步骤"}},[this._v("#")]),this._v(" 具体步骤")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" FOREIGN_KEY_CHECKS"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ----------------------------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Table structure for department")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ----------------------------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DROP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("IF")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("EXISTS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("dept_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("dept_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_general_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("money"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("decimal")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("dept_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_general_ci"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ----------------------------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- Records of department")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("-- ----------------------------")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INSERT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("INTO")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("department"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("VALUES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'采购部'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'200.00'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("每个数据库都需要一张"),s("code",[this._v("undo_log")]),this._v("的表，Seata需要使用")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("undo_log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("branch_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("xid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("context"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("rollback_info"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("longblob")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("log_status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("log_created"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("datetime")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("log_modified"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("datetime")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNIQUE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ux_undo_log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("xid"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("branch_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("li",[n("p",[t._v("启动TC")]),t._v(" "),n("p",[t._v("将seata-server-0.9.0.zip解压")]),t._v(" "),n("p",[t._v("找到bin目录在cmd打开，输入"),n("code",[t._v("seata-server -p 8888 -m file")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(171),alt:""}})]),t._v(" "),n("p",[t._v("-p 指定TC的端口号")]),t._v(" "),n("p",[t._v("-m 指定记录方式")]),t._v(" "),n("p",[t._v("当看到日志记录里出现"),n("code",[t._v("Server started...")]),t._v("就说明启动成功了")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("com.alibaba.cloud"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("spring-cloud-alibaba-seata"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("code",[this._v("register.conf")])]),this._v(" "),s("li",[s("code",[this._v("file.conf")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这两个文件在TC的压缩包里"),s("code",[this._v("/config")]),this._v("目录下有")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(172),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:a(173),alt:""}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("最后新建配置类，需要注意的是"),s("code",[this._v("DataSourceProxy")]),this._v("不要导错包")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("io.seata.rm.datasource.DataSourceProxy")])])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DatabaseConfiguration")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ConfigurationProperties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"spring.datasource.druid"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DruidDataSource")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ds0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DruidDataSource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Primary")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Bean")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataSource")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("dataSource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DruidDataSource")]),t._v(" ds0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DataSourceProxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ds0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("@GlobalTransactional")])])}],e=a(0),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),a("p",[t._v("Seata 是一款开源的分布式事务解决方案，致力于在微服务架构下提供高性能和简单易用的分布式事务服务。在 Seata 开源之前，Seata 对应的内部版本在阿里经济体内部一直扮演着分布式一致性中间件的角色，帮助经济体平稳的度过历年的双11，对各BU业务进行了有力的支撑。经过多年沉淀与积累，商业化产品先后在阿里云、金融云进行售卖。2019.1 为了打造更加完善的技术生态和普惠技术成果，Seata 正式宣布对外开源，未来 Seata 将以社区共建的形式帮助其技术更加可靠与完备。")]),t._v(" "),t._m(2),t._v(" "),a("p",[t._v("Seata的设计目标其一是对业务无侵入，因此从业务无侵入的2PC方案着手，在传统2PC的基础上演进，并解决2PC方案面临的问题。")]),t._v(" "),a("p",[t._v("Seata把分布式事务理解成一个包含了若干个分支的全局事务。全局事务的职责是协调其下管辖的分支事务达成一致，要么一起成功，要么一起失败回滚。此外，通常分支事务本身就是一个关系数据库的本地事务")]),t._v(" "),t._m(3),t._v(" "),a("p",[t._v("与传统的2PC的模式类似，Seata定义了3个组件分协助分布式事务的处理过程：")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("具体的执行流程如下：")]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),a("p",[t._v("​    架构层次方面，传统2PC方案的 RM 实际上是在数据库层，RM 本质上就是数据库自身，通过 XA 协议实现，而 Seata的 RM 是以jar包的形式作为中间件层部署在应用程序这一侧的。")]),t._v(" "),a("p",[t._v("​    两阶段提交方面，传统2PC无论第二阶段的决议是commit还是rollback，事务性资源的锁都要保持到Phase2完成 才释放。而Seata的做法是在Phase1 就将本地事务提交，这样就可以省去Phase2持锁的时间，整体提高效率。")]),t._v(" "),t._m(8),t._v(" "),a("ol",[a("li",[a("p",[t._v("准备分布式事务环境：")]),t._v(" "),a("p",[t._v("建两个数据库 seata1， seata2")]),t._v(" "),a("p",[t._v("数据库中建表，导入数据")]),t._v(" "),t._m(9),t._m(10),t._v(" "),t._m(11),a("p",[t._v("建两个微服务 seata-provider， seata-consumer")]),t._v(" "),a("p",[t._v("seata-provider使用seata1数据库， seata-consumer使用seata2数据库")]),t._v(" "),a("p",[t._v("微服务之间使用feign进行通信")]),t._v(" "),a("p",[t._v("下载 "),a("a",{attrs:{href:"https://github.com/seata/seata/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("事务协调器（TC）"),a("OutboundLink")],1)])]),t._v(" "),t._m(12)]),t._v(" "),a("p",[t._v("3、添加依赖：")]),t._v(" "),t._m(13),a("p",[t._v("添加配置文件")]),t._v(" "),a("p",[t._v("在resources目录添加以下文件：")]),t._v(" "),t._m(14),t._v(" "),t._m(15),t._v(" "),a("p",[t._v("修改配置文件")]),t._v(" "),a("p",[t._v('register.conf只需要注意register.type = "file"')]),t._v(" "),t._m(16),t._v(" "),a("p",[t._v('file.conf中更改service.vgroup_mapping.[springcloud服务名]-fescar-service-group = "default"')]),t._v(" "),a("p",[t._v("并修改 service.default.grouplist =[seata服务端地址]")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),a("p",[t._v("最后在需要开启全局事务的方法上加上注解")]),t._v(" "),t._m(21)])}),n,!1,null,null,null);s.default=r.exports}}]);